<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>众合林 - 空中农场</title>

	<meta name="aplus-terminal" content="1"> 
	<meta name="apple-mobile-web-app-capable" content="yes"> 
	<!-- 这meta的作用就是删除默认的苹果工具栏和菜单栏。content有两个值”yes”和”no” -->
	<meta name="apple-touch-fullscreen" content="no"> 
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"> 
	<meta name="format-detection" content="telephone=no"> 
	
	<!-- 清除微信缓存 -->
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/rem.js"></script>
	<!-- <link rel="stylesheet" type="text/css" href="css/reset.css"> -->
	<link rel="stylesheet" type="text/css" href="css/index.css">
	
	<script src="js/mobiscroll_002.js" type="text/javascript"></script>
	<script src="js/mobiscroll_004.js" type="text/javascript"></script>
	<link href="css/mobiscroll_002.css" rel="stylesheet" type="text/css">
	<link href="css/mobiscroll.css" rel="stylesheet" type="text/css">



	<!-- <link rel="stylesheet" href="css/mui.min.css"> -->
	<!--App自定义的css-->
	<!-- <link rel="stylesheet" type="text/css" href="css/app.css" /> -->
	<link href="css/mui.picker.css" rel="stylesheet" />
	<link href="css/mui.poppicker.css" rel="stylesheet" />


	<script src="js/mobiscroll.js" type="text/javascript"></script>
	<script src="js/mobiscroll_003.js" type="text/javascript"></script>
	<script src="js/mobiscroll_005.js" type="text/javascript"></script>
	<link href="css/mobiscroll_003.css" rel="stylesheet" type="text/css">
	<script src="js/city.js" type="text/javascript"></script>
</head>
<body class="orderinfobody" alltieinprice='0'>
<div class="address-wrap">
	<!-- 没有地址的时候 -->
	<div class="no-address hide">
		<span class="addressIcon"></span>
		<a href="javascript:;" class="add-address-btn ">请填写收货地址<i></i></a>
	</div>
	<!-- 有默认地址 -->
	<div class="yours-address show">
		<span class="addressIcon"></span>
		<div class="yours-address-content">
			<p>四川省 资阳市 安岳县 李家镇忠义乡牡丹村7组</p>
			<p><span>刘怡仁</span>&nbsp;<span>13787878782</span></p>
		</div>
		<a href="javascript:;" class="righticon"></a>
	</div>
</div>
<section class="storehouse">

	<div class="storehouse-col ">
		
		<div class="storehouse-info clearfix col-blue" status="1">
			<div class="storehouse-img fl">
				<img src="image/ji.jpg">
			</div>
			<div class="storehouse-shop-info fr">
				<div class="storehouse-shop-info-head">
					<h2>谷城土鸡</h2>
					<strong>20170414</strong>
				</div>
				<p class="updatatime">更新时间:2017-04-12</p>
				<div class="shop-save">
					<div class="storehouse-shop-col">
						<strong>1.8kg</strong>
						<span>重量</span>
					</div>
					<div class="storehouse-shop-col">
						<strong>12次</strong>
						<span>健康检查</span>
					</div>
					<div class="storehouse-shop-col">
						<strong>112天</strong>
						<span>距离出栏</span>
					</div>
				</div>
			</div>
		</div>
		

		<div class="tiein">
			<h3>套餐搭配</h3>
			<ul class="tiein-ul">
				<li data-price="8">
					<span class="selecte" data-isselect='0'></span>
					<div class="tiein-product">
						<a href="">谷城土鸡跑山鸡纯天然鸡(3个月时候的小土鸡，炒着吃，炖着吃)&nbsp;&nbsp;&nbsp;&nbsp;<i>&yen;8x1</i></a>
					</div>
					<div class="titin-num">
						<a href="javascript:;" class="pricedown">-</a>
						<input type="number" class="titin-text" value="1" disabled="" />
						<a href="javascript:;" class="priceup">+</a>
					</div>
				</li>
				<li data-price="20">
					<span class="selecte" data-isselect='0'></span>
					<div class="tiein-product">
						<a href="">谷城土鸡跑山鸡纯天然鸡(3个月时候的小土鸡，炒着吃，炖着吃)&nbsp;&nbsp;&nbsp;&nbsp;<i>&yen;20x1</i></a>
					</div>
					<div class="titin-num">
						<a href="javascript:;" class="pricedown">-</a>
						<input type="number" class="titin-text" value="5" disabled="" />
						<a href="javascript:;" class="priceup">+</a>
					</div>
				</li>
				<li data-price="80">
					<span class="selecte" data-isselect='0'></span>
					<div class="tiein-product">
						<a href="">谷城土鸡跑山鸡纯天然鸡(3个月时候的小土鸡，炒着吃，炖着吃)&nbsp;&nbsp;&nbsp;&nbsp;<i>&yen;80x1</i></a>
					</div>
					<div class="titin-num">
						<a href="javascript:;" class="pricedown">-</a>
						<input type="number" class="titin-text" value="1" disabled="" />
						<a href="javascript:;" class="priceup">+</a>
					</div>
				</li>
			</ul>
		</div>


		<div class="orderinfo clearfix">
			<div class="select-num fl">
				<div class="select-num-l">
					<div class="select-num-waper">
						认养<input type="number" value="1" />只
					</div>
				</div>
			</div>
			<div class="all-price fr">
				<div class="all-price-l">
					总计<span>99</span>元
				</div>
			</div>
		</div>


		 <div class="drop-info">
			<ul class="drop-info-ul ">
				<!-- <li><i class="usericon"></i><input type="text" name="" placeholder="收货人"><a href="javascript:;" class="select-user">点击选择</a></li>
				<li><i class="address"></i><input type="text" name="" placeholder="收货地址"></li>
				<li><i class="tel"></i><input type="text" name="" placeholder="联系电话"></li>
				<li><i class="time"></i><input type="text" name="" placeholder="点击选择快递日期"  class="appDate1"></li> -->
				<li><input type="button" class="subinfobtn" value="确定" name="" ></li>
			</ul>

			<!-- 确定之后状态 -->

			<!-- <ul class="drop-info-ul status-wrap hide">
				<li><span>收货人</span><a href="">张三</a></li>
				<li><span>地址</span><a href="">重庆市渝北区冉家坝哦北区冉家坝哦</a></li>
				<li><span>电话</span><a href="">18723032440</a></li>
				<li><span>日期</span><a href="">2017-08-09</a></li>
				<em class="logistics-status-icon status-icon"></em>

				
			</ul> -->

			<!-- 发货之后的状态: logistics-status-icon    确定信息之后的状态:right-status-icon-->
		</div> 
	</div>

</section>


<!-- 新增地址 -->

<div class="add-address hide">
	<ul class="add-ul">
		<li><span>收货人</span><input type="text" class="name"></li>
		<li><span>联系电话</span><input type="tel" class="tel"></li>
		<li><span>所在城市</span><a href="javascript:;" id="showCityPicker3"><i></i></a></li>
		<!-- <li><span>街道</span><input type="text"></li> -->
		<li class="area"><textarea class="street" placeholder="街道详细地址"></textarea></li>
	</ul>
	<div class="add-btn"><span class="add-back">返回</span><a href="javascript:;" class="addNewAddress">确定</a><a href="javascript:;" class="editAddress hide">确定</a></div>
</div>

<div class="addressList">
	<ul class="addressListUl">
		<li class="clearfix">
			<span class="address-select"></span>
			<div class="address-info fl">
				<p>四川省 资阳市 XXXXXXXXXXXXXXXXXXXXXXXX</p>
				<p><span>刘怡仁</span>&nbsp;<span>13787878782</span></p>
			</div>
			<div class="address-handle">
				<a href="javascript:;" class="edit"></a>
				<!-- <a href="javascript:;" class="delete"></a> -->
			</div>
		</li>
		<li class="clearfix">
			<span class="address-select"></span>
			<div class="address-info fl">
				<p>四川省 资阳市 安岳县 东城区东城区东城区东城区东城区东城区10-6</p>
				<p><span>刘怡仁</span>&nbsp;<span>13787878782</span></p>
			</div>
			<div class="address-handle">
				<a href="javascript:;" class="edit"></a>
				<!-- <a href="javascript:;" class="delete"></a> -->
			</div>
		</li>
		<li class="clearfix">
			<span class="address-select"></span>
			<div class="address-info fl">
				<p>四川省 资阳市 XXXXXXXXXXXX</p>
				<p><span>刘怡仁</span>&nbsp;<span>13787878782</span></p>
			</div>
			<div class="address-handle">
				<a href="javascript:;" class="edit"></a>
				<!-- <a href="javascript:;" class="delete"></a> -->
			</div>
		</li>
		
	</ul>
	<div style="height: 40px; width:100%;"></div>
	<div class="addressListbtn"><a href="javascript:;" class="addressListbtnsure">确定</a></div>
</div>


<!-- 常用联系人 -->
<!-- <section class="contact-use hide">
	<div class="contact-wrap">
		<h2>常用联系人</h2>
		<ul class="contact-wrap-ul">
			<li><em ></em>王麻子 1</li>
			<li><em ></em>王麻子 2</li>
			<li><em ></em>王麻子 3</li>
			<li><em ></em>王麻子 4</li>
			<li><em ></em>王麻子 5</li>
			<li class="closewinwrap"><span class="closewin"></span>关闭</li>
		</ul>
	</div>
</section> -->
<script src="js/mui.min.js"></script>
<!--<script src="../js/mui.picker.min.js"></script>-->
<script src="js/mui.picker.js"></script>
<script src="js/mui.poppicker.js"></script>
<script src="js/city.data-3.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
   //      $(function () {
			// var currYear = (new Date()).getFullYear();	
			// var opt={};
			// opt.date = {preset : 'date'};
			// opt.datetime = {preset : 'datetime'};
			// opt.time = {preset : 'time'};
			// opt.default = {
			// 	theme: 'android-ics light', //皮肤样式
		 //        display: 'modal', //显示方式 
		 //        mode: 'scroller', //日期选择模式
			// 	dateFormat: 'yyyy-mm-dd',
			// 	lang: 'zh',
			// 	showNow: true,
			// 	nowText: "今天",
		 //        startYear: currYear - 10, //开始年份
		 //        endYear: currYear + 10 //结束年份
			// };

		 //  	$(".appDate1").mobiscroll($.extend(opt['date'], opt['default']));
		 //  	$(".appDate2").mobiscroll($.extend(opt['date'], opt['default']));
		 //  	$(".appDate3").mobiscroll($.extend(opt['date'], opt['default']));
		 //  	$(".appDate4").mobiscroll($.extend(opt['date'], opt['default']));
   //      });
    </script>
	
    <script type="text/javascript">
    	var pirce=99;
    	$('body').attr('all-price',pirce);

    	$('.select-num-waper input').on('input',function(){
    		

    		$(this).val(parseInt($(this).val()));


    		if($(this).val().length>=4){
    			$(this).css({'font-size':'18px','margin-top':'-14px'});
    		}else if(parseInt($(this).val())==0){
    			$(this).val('1');
    		}else{
    			$(this).css({'font-size':'40px','margin-top':'-42px'})
    		}
    		
    		$('body').attr('all-price',$(this).val()*pirce);
    		$('body').attr('all-num',$(this).val());
    		var sTiein=parseInt($('body').attr('alltieinprice'));
    		$('.all-price-l span').html(sTiein+$(this).val()*pirce);
    	});


    	$('.tiein-ul li span').on('click',function(){
    		
    		var isselect=$(this).attr('data-isselect');
    		
			var initPrice=parseInt($('body').attr('all-price'));

			var inittieinPrice=parseInt($('body').attr('alltieinprice'));

			var price=$(this).parents('li').attr('data-price');
			var productnum=$(this).parents('li').find('.titin-num input').val();

			//alert(inittieinPrice)
    		if(isselect==0){
    			

    			$(this).addClass('active');
    			$(this).attr('data-isselect','1');

    			var nowprice=initPrice+parseInt(price*productnum);
    			$('.all-price-l span').html(nowprice);

    			$('body').attr('all-price',nowprice);

    			//套餐价格
    			$('body').attr('alltieinprice',inittieinPrice+parseInt(price*productnum));
    		}else{
    			$(this).removeClass('active');
    			$(this).attr('data-isselect','0');

    			var nowprice=initPrice-parseInt(price*productnum);
    			$('.all-price-l span').html(nowprice);

    			$('body').attr('all-price',nowprice);

    			//套餐价格
    			$('body').attr('alltieinprice',inittieinPrice-parseInt(price*productnum));
    		};
    	});

		
		$('.priceup').on('click',function(){

			var oT=$(this).parent().find('.titin-text');
			oT.val(parseInt(oT.val())+1);

			var price=parseInt($(this).parents('li').attr('data-price'));
			var isSelect=$(this).parents('li').find('.selecte').attr('data-isselect');

			var initPrice=parseInt($('body').attr('all-price'));
			var inittieinPrice=parseInt($('body').attr('alltieinprice'));
			if(isSelect==1){

				$('.all-price-l span').html(initPrice+price);

    			$('body').attr('all-price',initPrice+price);

    			//套餐价格
    			$('body').attr('alltieinprice',inittieinPrice+parseInt(price));
			}
		});
    	

    	$('.pricedown').on('click',function(){

			var oT=$(this).parent().find('.titin-text');
			oT.val(parseInt(oT.val())-1);

			var price=parseInt($(this).parents('li').attr('data-price'));
			var isSelect=$(this).parents('li').find('.selecte').attr('data-isselect');

			var initPrice=parseInt($('body').attr('all-price'));
			var inittieinPrice=parseInt($('body').attr('alltieinprice'));
			if(isSelect==1){

				$('.all-price-l span').html(initPrice-price);

    			$('body').attr('all-price',initPrice-price);

    			//套餐价格
    			$('body').attr('alltieinprice',inittieinPrice-parseInt(price));
			}
		});

    </script>

    <script type="text/javascript">
    	(function($, doc) {
			$.init();
			$.ready(function() {
				/**
				 * 获取对象属性的值
				 * 主要用于过滤三级联动中，可能出现的最低级的数据不存在的情况，实际开发中需要注意这一点；
				 * @param {Object} obj 对象
				 * @param {String} param 属性名
				 */
				var _getParam = function(obj, param) {
					return obj[param] || '';
				};
				
				//					//级联示例
				var cityPicker3 = new $.PopPicker({
					layer: 3
				});
				cityPicker3.setData(cityData3);
				var showCityPickerButton = doc.getElementById('showCityPicker3');
				var cityResult3 = doc.getElementById('showCityPicker3');
				showCityPickerButton.addEventListener('tap', function(event) {
					cityPicker3.show(function(items) {
						cityResult3.innerText =  _getParam(items[0], 'text') + " " + _getParam(items[1], 'text') + " " + _getParam(items[2], 'text');
						//返回 false 可以阻止选择框的关闭
						//return false;
					});
				}, false);
			});
		})(mui, document);
	</script>

	<script type="text/javascript">
		$(function(){

			//判断用户是否已有地址
			/*
				Code ...
			*/


			//新用户 没有地址信息
			$('.no-address').on('click',function(){
				$('.add-address').removeClass('hide').animate({'left':'0'},500);
			});	
			$('.add-btn .addNewAddress').on('click',function(){
				var oName=$('.name').val(),
					oTel=$('.tel').val(),
					oStreet=$('.street').val(),
					oSheng=$('#showCityPicker3').html();
				if(oName=='' || oTel=='' || oStreet=='' || oSheng==''){
					alert('请填写完整！');
					return false;
				}else{

					//得到信息 送到数据库
					var sAddressInfo={
						'name':oName,
						'tel':oTel,
						'street':oStreet,
						'sheng':oSheng
					}

					//将这条信息存进cookie 等下获取列表

					//setCookie('address',JSON.stringify(sAddressInfo),1);

					console.log(sAddressInfo);
					$('.no-address').removeClass('show').addClass('hide');
					$('.yours-address').removeClass('hide').addClass('show');
					$('.yours-address .yours-address-content').html('<p>'+oSheng +'&nbsp;&nbsp;&nbsp;'+oStreet+'</p><p><span>'+oName+'</span>&nbsp;<span>'+oTel+'</span></p>');
					$('.add-address').animate({'left':'400'},500,function(){
						$('.add-address').addClass('hide')
					});
				}
			});

			$('.yours-address').on('click',function(){
				//发送请求获取地址列表
				//拿到刚才存的假数据

				//var datas=getCookie('address');
				var datas=[
					{
						'id':"1",
						'name':"陈洪波",
						'tel':"13425256223",
						'street':" XXXXX萨迪克救艾斯可怜的街道",
						'sheng':"湖北省 襄阳市 谷城县"
					},
					{
						'id':"2",
						'name':"周华盛",
						'tel':"13425200000",
						'street':" XXX哦哦一ii可怜的街道",
						'sheng':"湖北省 襄阳市 谷0000"
					}
				];
				//假如多条
				//console.log(datas)
				var shtml='';
				for(var i=0; i<datas.length;i++){
					//console.log(datas);
					shtml+='<li class="clearfix" datas="'+encodeURIComponent(JSON.stringify(datas[i]))+'"><span class="address-select"></span>\
						<div class="address-info fl">\
							<p>'+datas[i].sheng+'&nbsp;'+datas[i].street+'</p><p><span>'+datas[i].name+'</span>&nbsp;<span>'+datas[i].tel+'</span></p>\
						</div><div class="address-handle">\
							<a href="javascript:;" class="edit" addressId="'+datas[i].id+'"></a></div></li>';
				}
				$('.addressListUl').html(shtml);
				$('.addressList').removeClass('hide').addClass('show').animate({'left':'0'},500);

				//选择 

				$('.address-select').on('click',function(){
					$('.address-select').removeClass('active').parents('li').attr('isselected','0');
					$(this).addClass('active').parents('li').attr('isselected','1');

				});

				//确定
				$('.addressListbtnsure').on('click',function(){
					$('.addressListUl li').each(function(ind){
						var selected=$(this).attr('isselected');
						///alert(selected);
						if(selected==1){
							var datasInfo=eval('('+decodeURIComponent($(this).attr('datas'))+')');
							console.log(datasInfo);

							$('.yours-address .yours-address-content').html('<p>'+datasInfo.sheng +'&nbsp;&nbsp;&nbsp;'+datasInfo.street+'</p><p><span>'+datasInfo.name+'</span>&nbsp;<span>'+datasInfo.tel+'</span></p>');
							
							$('.addressList').animate({'left':'400'},500,function(){
								$('.addressList').removeClass('show').addClass('hide')
							});
						}
					})
					
					
				})


				//修改地址
				var addressId='';
				$('.address-handle .edit').on('click',function(){
					//alert(123);

					addressId=$(this).attr('addressid');
					$('.add-address').removeClass('hide').animate({'left':'0'},500);
					var datasInfo=eval('('+decodeURIComponent($(this).parents('li').attr('datas'))+')');
					//console.log(datasInfo);

					$('.name').val(datasInfo.name);
					$('.tel').val(datasInfo.tel);
					$('#showCityPicker3').html(datasInfo.sheng);
					$('.street').val(datasInfo.street);

					$('.add-btn .addNewAddress').addClass('hide');
					$('.add-btn .editAddress').removeClass('hide');

				});


				$('.editAddress').on('click',function(){
					//将修改的信息发送到数据库

					//然后返回列表页面 重新获取数据展示列表

					//
					var oBtn=$('.addressListUl li .address-handle a');
					var oName=$('.name').val(),
						oTel=$('.tel').val(),
						oStreet=$('.street').val(),
						oSheng=$('#showCityPicker3').html();
						oBtn.each(function(ind){
						//alert(addressId+'---'+oBtn.eq(ind).attr('addressid'))
						if(oBtn.eq(ind).attr('addressid')==addressId){
							oBtn.eq(ind).parents('li').find('.address-info').html('<p>'+oSheng+'&nbsp; '+oStreet+'</p><p><span>'+oName+'</span>&nbsp;<span>'+oTel+'</span></p>');
							var jsons='{"id":"'+addressId+'","name":"'+oName+'","tel":"'+oTel+'","street":" '+oStreet+'","sheng":"'+oSheng+'"}'
							oBtn.eq(ind).parents('li').attr('datas',encodeURIComponent(jsons));
						};

						$('.add-address').animate({'left':'400'},500,function(){
							$('.add-address').addClass('hide');
							$('.add-btn .addNewAddress').removeClass('hide');
							$('.add-btn .editAddress').addClass('hide');
						});
					});
					//alert(addressId)
				});
			});
			
			$('.add-back').on('click',function(){
				$('.add-address').animate({'left':'400'},500,function(){
					$('.add-address').addClass('hide')
				});
			})
			
		});
	</script>
</body>
</html>